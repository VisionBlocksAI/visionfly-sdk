!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("next/image")):"function"==typeof define&&define.amd?define(["exports","react","next/image"],t):t((e||self).visionflySdk={},e.react,e.Image)}(this,function(e,t,r){function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=/*#__PURE__*/n(r);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(null,arguments)}function o(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}var u=t.createContext(null);function s(){var e=t.useContext(u);if(!e)throw new Error("useVisionFly must be used within a VisionFlyProvider");return e}var l=["src","width","height","quality","format","blur","sharpen","brightness","contrast","saturation","hue","alt","placeholder"],f=["src","widths","sizes","quality","format","fill","alt","placeholder"];function c(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}e.VFNextImage=function(e){var r=e.src,n=e.width,u=e.height,f=e.quality,d=e.format,v=e.blur,m=e.sharpen,g=e.brightness,b=e.contrast,p=e.saturation,y=e.hue,w=e.alt,P=void 0===w?"":w,S=e.placeholder,q=void 0===S?"blur":S,x=o(e,l),U=s(),F=U.client,j=U.ready,O=t.useState(""),I=O[0],L=O[1],R=t.useState(""),V=R[0],z=R[1],B=t.useState(!0),C=B[0],E=B[1];return t.useEffect(function(){j&&r&&function(){try{var e=c(function(){return Promise.resolve(F.getImageUrl({src:r,width:n,height:u,quality:f,format:d,blur:v,sharpen:m,brightness:g,contrast:b,saturation:p,hue:y})).then(function(e){function t(){E(!1)}L(e);var n=function(){if("blur"===q)return Promise.resolve(F.getImageUrl({src:r,width:20,quality:20,format:"webp",blur:10})).then(function(e){return Promise.resolve(fetch(e)).then(function(e){return Promise.resolve(e.arrayBuffer()).then(function(e){var t=Buffer.from(e).toString("base64");z("data:image/webp;base64,"+t)})})})}();return n&&n.then?n.then(t):t()})},function(e){console.error("Failed to load image:",e),E(!1)});return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}()},[F,j,r,n,u,f,d,v,m,g,b,p,y,q]),C||!I?h("div",{style:{width:n||"100%",height:u||"300px",backgroundColor:"#f0f0f0"}}):h(i.default,a({src:I,alt:P,width:n,height:u,blurDataURL:V,placeholder:q},x))},e.VFNextResponsiveImage=function(e){var r=e.src,n=e.widths,u=e.sizes,l=e.quality,d=e.format,v=e.fill,m=void 0===v||v,g=e.alt,b=void 0===g?"":g,p=e.placeholder,y=void 0===p?"blur":p,w=o(e,f),P=s(),S=P.client,q=P.ready,x=t.useState(null),U=x[0],F=x[1],j=t.useState(""),O=j[0],I=j[1],L=t.useState(!0),R=L[0],V=L[1];return t.useEffect(function(){q&&r&&function(){try{var e=c(function(){return Promise.resolve(S.getSrcSet({src:r,widths:n,format:d,quality:l})).then(function(e){function t(){V(!1)}F(e);var n=function(){if("blur"===y)return Promise.resolve(S.getImageUrl({src:r,width:20,quality:20,format:"webp",blur:10})).then(function(e){return Promise.resolve(fetch(e)).then(function(e){return Promise.resolve(e.arrayBuffer()).then(function(e){var t=Buffer.from(e).toString("base64");I("data:image/webp;base64,"+t)})})})}();return n&&n.then?n.then(t):t()})},function(e){console.error("Failed to load srcset:",e),V(!1)});return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}()},[S,q,r,n&&JSON.stringify(n),l,d,y]),R||!U?h("div",{style:{position:m?"relative":"static",width:"100%",height:m?"100%":"300px",backgroundColor:"#f0f0f0"}}):h(i.default,a({src:U.default,alt:b,blurDataURL:O,placeholder:y,fill:m,sizes:u||U.sizes,loader:function(e){var t=e.width,r=new URL(e.src),n=Object.fromEntries(r.searchParams.entries());t&&(n.w=t);var i=new URLSearchParams(n);return""+r.origin+r.pathname+"?"+i.toString()}},w))},e.setupVisionFly=function(e,t){return void 0===t&&(t={}),{imageLoader:function(r){var n=r.src,i=r.width,a=r.quality;return n.includes(e.baseUrl||"api.visionfly.ai")?n:(e.baseUrl||"https://api.visionfly.ai")+"/transform?"+new URLSearchParams({src:n,w:i||"",q:a||80,f:t.defaultFormat||"auto"}).toString()}}}});
//# sourceMappingURL=next.umd.js.map
